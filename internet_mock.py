import os

bandwidths = [
    '34577216bps',
    '35683200bps',
    '33535776bps',
    '26393216bps',
    '24296352bps',
    '21725248bps',
    '35721664bps',
    '28666400bps',
    '40349376bps',
    '33131968bps',
    '47047936bps',
    '44536096bps',
    '32702464bps',
    '32136800bps',
    '40150080bps',
    '17540384bps',
    '28746528bps',
    '33573728bps',
    '48920736bps',
    '40260416bps',
    '28801120bps',
    '40156640bps',
    '30097888bps',
    '36320288bps',
    '41117920bps',
    '27268224bps',
    '25983360bps',
    '35248736bps',
    '30606048bps',
    '58685056bps',
    '39268128bps',
    '32964608bps',
    '28698336bps',
    '38216192bps',
    '52706080bps',
    '40299808bps',
    '28889600bps',
    '12843744bps',
    '29884416bps',
    '41785792bps',
    '42926080bps',
    '29851648bps',
    '33062912bps',
    '40506784bps',
    '40553504bps',
    '10201664bps',
    '36777824bps',
    '37720480bps',
    '40075200bps',
    '18591616bps',
    '28468864bps',
    '44030048bps',
    '43024384bps',
    '49086048bps',
    '34832384bps',
    '47185920bps',
    '40064832bps',
    '14612320bps',
    '46202880bps',
    '40983808bps',
    '32866304bps',
    '40361312bps',
    '33644512bps',
    '40620672bps',
    '40173184bps',
    '36837472bps',
    '33137856bps',
    '32325632bps',
    '23289440bps',
    '40321376bps',
    '34930688bps',
    '21436928bps',
    '23208000bps',
    '38519264bps',
    '42909536bps',
    '36104832bps',
    '36218240bps',
    '62472192bps',
    '28573696bps',
    '45776896bps',
    '22033888bps',
    '40683296bps',
    '37946496bps',
    '28652480bps',
    '39911424bps',
    '27911456bps',
    '32281888bps',
    '37655744bps',
    '42172416bps',
    '36353408bps',
    '24592480bps',
    '10169312bps',
    '45282624bps',
    '40577088bps',
    '40864800bps',
    '63455232bps',
    '28856288bps',
    '16769120bps',
    '40005568bps',
    '32241248bps',
    '30932992bps',
    '30572640bps',
    '31388704bps',
    '13577056bps',
    '40240224bps',
    '58195968bps',
    '23324000bps',
    '40421248bps',
    '34974976bps',
    '44855872bps',
    '37278976bps',
    '35691552bps',
    '40847360bps',
    '14914528bps',
    '28835840bps',
    '14707744bps',
    '42979584bps',
    '35726816bps',
    '35287520bps',
    '39464704bps',
    '32458560bps',
    '49081984bps',
    '30539776bps',
    '44040384bps',
    '11560448bps',
    '51552512bps',
    '51462144bps',
    '50509184bps',
    '42484608bps',
    '71607424bps',
    '32686080bps',
    '42012704bps',
    '36589824bps',
    '35160064bps',
    '21314784bps',
    '36072480bps',
    '52235968bps',
    '41156608bps',
    '47974720bps',
    '17039360bps',
    '42135680bps',
    '16113120bps',
    '32444256bps',
    '40468416bps',
    '40114464bps',
    '32308352bps',
    '38749984bps',
    '35350592bps',
    '40073632bps',
    '31166464bps',
    '39121440bps',
    '37584896bps',
    '45203008bps',
    '27754496bps',
    '40934560bps',
    '39320160bps',
    '33066912bps',
    '44597248bps',
    '37928160bps',
    '13641760bps',
    '36543904bps',
    '38222784bps',
    '40551328bps',
    '27082752bps',
    '57720832bps',
    '45088544bps',
    '38924672bps',
    '32309248bps',
    '42937504bps',
    '33464960bps',
    '43057152bps',
    '29904128bps',
    '52297728bps',
    '36282976bps',
    '39686624bps',
    '52314112bps',
    '55687040bps',
    '39665824bps',
    '30466304bps',
    '33269056bps',
    '34183424bps',
    '28449024bps',
    '31418304bps',
    '40652544bps',
    '31753952bps',
    '40425728bps',
    '53018624bps',
    '36590720bps',
    '39852032bps',
    '16817024bps',
    '30998528bps',
    '14348736bps',
    '29159776bps',
    '38797856bps',
    '54689824bps',
    '35541056bps',
    '39835392bps',
    '54755328bps',
    '34114720bps',
    '28791616bps',
    '35716608bps',
    '36448928bps',
    '39941504bps',
    '54131968bps',
    '36725952bps',
    '39937760bps',
    '60276736bps',
    '34227360bps',
    '33085824bps',
    '49946464bps',
    '41320448bps',
    '33161216bps',
    '42247680bps',
    '37263872bps',
    '47005696bps',
    '34996224bps',
    '33101184bps',
    '41791520bps',
    '43150080bps',
    '39883456bps',
    '31732256bps',
    '40304992bps',
    '34886688bps',
    '41874112bps',
    '25320832bps',
    '39450880bps',
    '34494496bps',
    '3619584bps',
    '39603424bps',
    '40379456bps',
    '26104128bps',
    '44147712bps',
    '9522272bps',
    '18752960bps',
    '39668832bps',
    '44519872bps',
    '40332160bps',
    '35912800bps',
    '15427104bps',
    '36847616bps',
    '33155616bps',
    '36227648bps',
    '28839968bps',
    '38711584bps',
    '21934656bps',
    '34154240bps',
    '20748416bps',
    '37461248bps',
    '31391744bps',
    '59473920bps',
    '37275456bps',
    '34456832bps',
    '31047136bps',
    '45793760bps',
    '47628288bps',
    '50258368bps',
    '20931744bps',
    '40056544bps',
    '45387776bps',
    '39732800bps',
    '43843584bps',
    '38993920bps',
    '34997600bps',
    '32806240bps',
    '40608992bps',
    '27893184bps',
    '37722784bps',
    '43379456bps',
    '30658368bps',
    '34471936bps',
    '47661056bps',
    '36201504bps',
    '39561440bps',
    '32682208bps',
    '41664512bps',
    '26493376bps',
    '32705792bps',
    '35405824bps',
    '35460576bps',
    '4604768bps',
    '25603424bps',
    '30347584bps',
    '10277152bps',
    '19251200bps',
    '40535200bps',
    '32416160bps',
    '54553568bps',
    '28963520bps',
    '40012576bps',
    '49604320bps',
    '38711264bps',
    '46521376bps',
    '39994944bps',
    '38567936bps',
    '43810816bps',
    '45558656bps',
    '33332544bps',
    '49411168bps',
    '33243136bps',
    '40484864bps',
    '46888608bps',
    '56066048bps',
    '16612128bps',
    '24825376bps',
    '25870336bps',
    '36195808bps',
    '23685600bps',
    '33948768bps',
    '57098240bps',
    '39933760bps',
    '29751424bps',
    '46645248bps',
    '34537472bps',
    '46653952bps',
    '42111520bps',
    '30551872bps',
    '36271584bps',
    '32247328bps',
    '24487744bps',
    '33617952bps',
    '22478848bps',
    '29839968bps',
    '40148800bps',
    '38536064bps',
    '29983104bps',
    '34336576bps',
    '38179360bps',
    '24823488bps',
    '54104384bps',
    '31539200bps',
    '35042880bps',
    '24223744bps',
    '33795808bps',
    '41877504bps',
    '32014144bps',
    '32104736bps',
    '28345536bps',
    '40360992bps',
    '36737056bps',
    '40337760bps',
    '32032928bps',
    '27672576bps',
    '31624128bps',
    '34226112bps',
    '34039168bps',
    '43500160bps',
    '13857440bps',
    '40396640bps',
    '12692768bps',
    '29031552bps',
    '647040bps',
    '34088224bps',
    '40348960bps',
    '59310080bps',
    '40313024bps',
    '59506688bps',
    '47822560bps',
    '31656544bps',
    '26646656bps',
    '40307616bps',
    '52845152bps',
    '45490784bps',
    '41194592bps',
    '40310592bps',
    '34222912bps',
    '32538624bps',
    '54853632bps',
    '58916864bps',
    '47054848bps',
    '37111616bps',
    '47095456bps',
    '28725792bps',
    '34466336bps',
    '50132544bps',
    '56401504bps',
    '32777376bps',
    '39824768bps',
    '10257824bps',
    '55017472bps',
    '34422784bps',
    '11354112bps',
    '47785056bps',
    '39610784bps',
    '6160384bps',
    '34671808bps',
    '40123392bps',
    '33070208bps',
    '40505728bps',
    '40710656bps',
    '35686112bps',
    '27216288bps',
    '35067712bps',
    '47607552bps',
    '40218720bps',
    '31425568bps',
    '37409696bps',
    '47750592bps',
    '30774976bps',
    '40348128bps',
    '40448096bps',
    '29458432bps',
    '33421088bps',
    '41694528bps',
    '22323680bps',
    '23366208bps',
    '35848192bps',
    '27582944bps',
    '21050368bps',
    '38919360bps',
    '41166880bps',
    '57606336bps',
    '25228960bps',
    '32223008bps',
    '31421312bps',
    '40240704bps',
    '39790656bps',
    '34772000bps',
    '38557856bps',
    '20261056bps',
    '28596928bps',
    '36016864bps',
    '32997376bps',
    '35272480bps',
    '44624416bps',
    '33357824bps',
    '40496224bps',
    '36745088bps',
    '28866976bps',
    '40739040bps',
    '38557472bps',
    '7419392bps',
    '40770592bps',
    '34439168bps',
    '19792992bps',
    '35717120bps',
    '24870912bps',
    '34920928bps',
    '29574976bps',
    '32079872bps',
    '36691488bps',
    '35319904bps',
    '35087104bps',
    '49740832bps',
    '33997728bps',
    '32639744bps',
    '28797472bps',
    '46462528bps',
    '52119072bps',
    '34831744bps',
    '10911744bps',
    '38981216bps',
    '18915136bps',
    '47444256bps',
    '58780224bps',
    '30392928bps',
    '39882112bps',
    '37693344bps',
    '12304544bps',
    '47693824bps',
    '26505408bps',
    '51309696bps',
    '38892384bps'
]
bandwidths_low = [
    '100000bps',
    '150000bps',
    '205000bps',
    '250000bps',
    '300000bps',
    '350000bps',
    '400000bps',
    '450000bps',
    '500000bps',
    '550000bps',
    '600000bps',
    '650000bps',
    '705000bps',
    '750000bps',
    '800000bps',
    '850000bps',
    '900000bps',
    '950000bps',
    '1000000bps',
]

LOSS = [
    2,
    4,
    6,
    8,
    10,
    12
]
class TCNetem:
    def __init__(self,):
        pass
        # os.system('sudo tc qdisc del dev ens4 root')
        # os.system('sudo tc qdisc del dev lo root')
        # os.system('echo \"1\" | sudo pkill chromium')
        # os.system('echo \"1\" | sudo pkill chromedriver')
        # self.set_bandwidth_limit(bandwidth=bw)
    
    def set_bandwidth_limit(self, bandwidth):
        print("set bw")
        os.system('echo \"1\" | sudo -S tc qdisc replace dev ens4 root netem rate {}mbit'.format(bandwidth))
        os.system('echo \"1\" | sudo -S tc qdisc replace dev lo root netem rate {}mbit'.format(bandwidth))

    def loss_package(self, loss):
        print("loss:" + str(loss) + "%") 
        os.system('echo \"1\" | sudo -S tc qdisc add dev ens4 root netem loss {}%'.format(loss))
        os.system('echo \"1\" | sudo -S tc qdisc add dev lo root netem loss {}%'.format(loss))
        print("set limmit complete!")

    def reset(self,):
        os.system('echo \"1\" | sudo -S tc qdisc del dev ens4 root')
        os.system('echo \"1\" | sudo -S tc qdisc del dev lo root')
        os.system('echo \"1\" | sudo -S pkill chromium')
        os.system('echo \"1\" | sudo -S pkill chromedriver')
